#ifndef MALWARE_SCANNER_H
#define MALWARE_SCANNER_H

#include "AhoCorasick.h"
#include "Trie.h"
#include <string>
#include <vector>

class MalwareScanner {
private:
    AhoCorasick* scanner;
    Trie* signatureDB;
    std::vector<std::string> signatures;
    
public:
    MalwareScanner();
    ~MalwareScanner();
    
    void loadSignatures(const std::string& filename);
    void addSignature(const std::string& signature);
    std::vector<std::pair<int, std::string>> scanFile(const std::string& filename);
    std::vector<std::pair<int, std::string>> scanText(const std::string& text);
    void displayResults(const std::vector<std::pair<int, std::string>>& matches);
};

#endif // MALWARE_SCANNER_H
